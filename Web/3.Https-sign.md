server数组

get请求构造

题目源码

![](https://cdn.nlark.com/yuque/0/2024/png/45579424/1728649821402-bb3cb357-7503-474b-a1cd-7f449c813be3.png)



我们先来分析一下



<font style="color:rgb(0, 0, 187);">$laodeng </font><font style="color:rgb(0, 119, 0);">= </font><font style="color:rgb(0, 0, 187);">$_GET</font><font style="color:rgb(0, 119, 0);">[</font><font style="color:rgb(221, 0, 0);">'laodeng'</font><font style="color:rgb(0, 119, 0);">];  
</font><font style="color:rgb(0, 119, 0);">从get请求中获得变量laodeng</font>

<font style="color:rgb(0, 119, 0);"></font>

<font style="color:rgb(0, 119, 0);">if (</font><font style="color:rgb(0, 0, 187);">basename</font><font style="color:rgb(0, 119, 0);">(</font><font style="color:rgb(0, 0, 187);">$_SERVER</font><font style="color:rgb(0, 119, 0);">[</font><font style="color:rgb(0, 0, 187);">$laodeng</font><font style="color:rgb(0, 119, 0);">]) === </font><font style="color:rgb(221, 0, 0);">'flag.php'</font><font style="color:rgb(0, 119, 0);">)  
</font><font style="color:rgb(0, 119, 0);">检查SERVER数组中的laodeng元素的名字  如果是flag.php，那就下一步</font>

<font style="color:rgb(0, 119, 0);"></font>

<font style="color:rgb(0, 119, 0);">echo </font><font style="color:rgb(0, 0, 187);">file_get_contents</font><font style="color:rgb(0, 119, 0);">(</font><font style="color:rgb(221, 0, 0);">"flag.php"</font><font style="color:rgb(0, 119, 0);">);获取flag.php内容，相当于输出flag了</font>



分析差不多这么多



我们的思路就是呢，用get请求发个包，来在server数组中加入一个laodeng元素，再把laodeng的名字赋值为flag.php



这就涉及一个知识了，我们如何通过get请求来影响server数组？



[$_SERVER获取服务器信息_下列代码是应用＄server全局变量获取服务器和客户端的相关信息请补全代码-CSDN博客](https://blog.csdn.net/kjw001122/article/details/79857309)



参考文献，因为我们要用get请求发包嗯，我们来看看get包中可能传入server数组的元素

![](https://cdn.nlark.com/yuque/0/2024/png/45579424/1728651776644-8bb23274-ba35-4dc4-a206-6a3b3c8cc257.png)

这个user-name就是很不错  
![](https://cdn.nlark.com/yuque/0/2024/png/45579424/1728651890614-62ada2a3-eded-404a-9e86-90b32d40562e.png)



其他的好像，呃呃，格式不是字符串，这里不能伪造

![](https://cdn.nlark.com/yuque/0/2024/png/45579424/1728652910997-a6a6de47-2291-49d7-865f-79a7ea6f3242.png)

![](https://cdn.nlark.com/yuque/0/2024/png/45579424/1728652996889-68fa94c6-189f-4449-a90c-8be9dbe1d970.png)



这些也可以入手啊，如果你想伪造多个，就一起来呗

